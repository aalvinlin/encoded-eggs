<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Encoded Eggs</title>

    <link rel="stylesheet" href="./index.css" />

    <script src="./story.js"></script>
    <script src="./encodings.js"></script>

    <script>

        const encodings = {
            "ROT 13": rot13_transform,
            "Semaphore": null,
            "Braille": null,
            "Number": number_transform
        }

        let encodingChoice = null;

        let currentPageNumber = null;
        let currentLineNumber = null;
        let currentEncodedLine = null;

        const setEncodingChoice = choice => {
            encodingChoice = choice;

            document.getElementById("egg-chooser").classList.toggle("hidden")
            document.getElementById("subheading-instruction").classList.toggle("hidden")
            document.getElementById("subheading-back").classList.toggle("hidden")
            document.getElementById("encoded-text").classList.toggle("hidden")

            if (encodings[choice])
                {
                    // update subheading
                    document.getElementById("subheading-chosen").textContent = choice;

                    // set first line of text
                    currentPageNumber = 0;
                    currentLineNumber = 0;
                    currentEncodedLine = encodings[choice](text[currentPageNumber][currentLineNumber]);

                    document.getElementById("current-line").appendChild(currentEncodedLine);
                }
        }

        const goBackToMenu = () => {
            encodingChoice = null;

            document.getElementById("subheading-instruction").classList.toggle("hidden")
            document.getElementById("subheading-back").classList.toggle("hidden")
            document.getElementById("encoded-text").classList.toggle("hidden");
            document.getElementById("egg-chooser").classList.toggle("hidden");

            let currentLine = document.getElementById("current-line");

            while (currentLine.hasChildNodes())
                { currentLine.removeChild(currentLine.childNodes[0]); }
        }

    </script>

</head>
<body>

    <header>
        <h1>Encoded Eggs</h1>
    </header>

    <section class="subheading" id="subheading-instruction">
        <h2>Choose an Encoding</h2>
    </section>

    <section class="subheading hidden" id="subheading-back">
        <p onClick="goBackToMenu()">&#9664; Back to Menu</p>
        <h2 id="subheading-chosen"></h2>
        <p></p>
    </section>

    <div class="content-container">

        <div class="content">

            <div id="egg-chooser">

                <div class="egg-choice" onClick="setEncodingChoice('ROT 13')">
                    <div class="egg">
                        egg
                    </div>
                    <h3>ROT 13</h3>
                </div>

                <div class="egg-choice" onClick="setEncodingChoice('Semaphore')">
                    <div class="egg">
                        egg
                    </div>
                    <h3>Semaphore</h3>
                </div>

                <div class="egg-choice" onClick="setEncodingChoice('Braille')">
                    <div class="egg">
                        egg
                    </div>
                    <h3>Braille</h3>
                </div>

                <div class="egg-choice" onClick="setEncodingChoice('Number')">
                    <div class="egg">
                        egg
                    </div>
                    <h3>Number</h3>
                </div>

            </div>

            <div id="encoded-text" class="hidden">

                <div id="current-line">

                </div>

            </div>

        </div>

    </div>
    
</body>
</html>