<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Encoded Eggs</title>

    <link rel="stylesheet" href="./index.css" />

    <script src="./story.js"></script>
    <script src="./encodings.js"></script>

    <script>

        const encodings = {
            "rot13": rot13_transform,
            "semaphore": null,
            "Braille": null,
        }

        let encodingChoice = null;

        let currentPageNumber = null;
        let currentLineNumber = null;
        let currentEncodedLine = null;

        const setEncodingChoice = choice => {
            encodingChoice = choice;
            document.getElementById("egg-chooser").classList.add("hidden")
            document.getElementById("encoded-text").classList.remove("hidden")

            // set first line of text
            if (encodings[choice])
                {
                    currentPageNumber = 0;
                    currentLineNumber = 0;
                    currentEncodedLine = encodings[choice](text[currentPageNumber][currentLineNumber]);

                    let textElement = document.createElement("p");
                    textElement.textContent = currentEncodedLine;

                    document.getElementById("current-line").appendChild(textElement);
                }
        }

        const goBackToMenu = () => {
            encodingChoice = null;
            document.getElementById("encoded-text").classList.add("hidden");
            document.getElementById("egg-chooser").classList.remove("hidden");

            let currentLine = document.getElementById("current-line");

            while (currentLine.hasChildNodes())
                { currentLine.removeChild(currentLine.childNodes[0]); }
        }

    </script>

</head>
<body>

    <div class="content-container">

        <div class="content">

            <div id="egg-chooser">
                <h1>Encoded Eggs</h1>

                    <div class="egg-choices">

                        <div class="egg-choice" onClick="setEncodingChoice('rot13')">
                            <div class="egg">
                                egg
                            </div>
                            <h3>ROT 13</h3>
                        </div>

                        <div class="egg-choice" onClick="setEncodingChoice('semaphore')">
                            <div class="egg">
                                egg
                            </div>
                            <h3>semaphore</h3>
                        </div>

                        <div class="egg-choice" onClick="setEncodingChoice('Braille')">
                            <div class="egg">
                                egg
                            </div>
                            <h3>Braille</h3>
                        </div>

                    </div>

                <h2>Choose an Encoding</h2>
            </div>

            <div id="encoded-text" class="hidden">

                <div id="back-to-menu" onClick="goBackToMenu()">
                    Back
                </div>

                <div id="current-line">

                </div>

            </div>

        </div>

    </div>
    
</body>
</html>